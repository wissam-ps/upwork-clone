(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{1232:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(362),c=n(234);var l=function(e,t,n,o){const r="up_g_one_tap_closed",l=new Date((new Date).getTime()+864e5);return!o.get(r)&&(n("impression","show_widget"),window.google.accounts.id.initialize({client_id:e,callback:e=>{t(e.credential)},nonce:Object(c.a)("oneTap_")}),window.google.accounts.id.prompt((e=>{"tap_outside"===e.getSkippedReason()&&o.set(r,!0,{expires:l})})),!0)};let d;var h=Object(o.defineComponent)({methods:{trackEvent(e){const t="page"===e.event?["olog"]:["olog","snowplow"];return this.$tracker.track({...e,trackers:t})},async logEvent(e){const t={...e};var n;n="id",{}.hasOwnProperty.call(e.data||{},n)&&(t.data.id=this.$store.state.context.user.uid),await this.trackEvent(t)},async logImpressionEvent(e,t){!d&&t&&(await this.logEvent(t),d=!0),await this.logEvent(e)},extendLogData:(e,data)=>({...e,data:{...e.data||{},...data}})}}),w=n(2),f=Object(w.a)(h,undefined,undefined,!1,null,null,null).exports;const m=e=>'\n    mutation {\n        redirectUrl(input: {\n            credential: "'.concat(e,'"\n        }) {\n        login\n        redirectStatusDetail\n        redirectTo\n        success\n        }\n    }\n');class v{constructor(e,t){this.$httpGql=void 0,this.$logger=void 0,this.$httpGql=e,this.$logger=t}async authorizeWithOneTap(e){if(!e)return{login:!1,redirectTo:null};try{var t;const{data:data,errors:n}=await this.$httpGql({handleApiErrors:!0,useSubordinateOauth:!0}).post({query:m(e)}).json();if(!n)return(null==data?void 0:data.redirectUrl)||{};null===(t=this.$logger)||void 0===t||t.error("[ACQ] onTapRedirectUrl error: ",n)}catch(e){var n;null===(n=this.$logger)||void 0===n||n.error("[ACQ] onTapRedirectUrl error: ",e)}return!1}}var k=Object(o.defineComponent)({name:"GoogleOneTap",mixins:[f],props:{clientId:{type:String,required:!0}},head(){return{script:[{hid:"google-qsi-client",src:"https://accounts.google.com/gsi/client",defer:!0,callback:()=>{l(this.clientId,this.signUpWithOneTap,this.logWidget,this.$cookies)}}]}},methods:{logWidget(e,label){this.logEvent({event:e,sublocation:"one_tap_sign_up",label:label})},async signUpWithOneTap(e){var t,n,o;await(null===(t=(n=this.$nuxt.context).$loadFlags)||void 0===t?void 0:t.call(n,this.$store,{ff:[{name:"MP18843OneTapRedirectURL",fallback:!1}]}));const r=null===(o=this.$store.state.flags.ff)||void 0===o?void 0:o.MP18843OneTapRedirectURL,{login:c,redirectTo:l}=await this.authorizeWithOneTap(e,r);if(c)try{var d,h;if(!await this.logIn(c,e))return;await this.$store.dispatch("context/change"),this.logWidget("click","existing_user_with_one_tap");const t=await(null===(d=(h=this.$nuxt.context).$getHomeRedirect)||void 0===d?void 0:d.call(h,this.$nuxt.context));window.location.href=this.$localePrefix(t.redirectUrl)}catch(e){"password"===e&&(this.logWidget("click","existing_user_without_one_tap"),window.localStorage.setItem("existingAccountLoginAlert",!0)),window.location.href=this.$localePrefix("/ab/account-security/login")}else l&&(this.logWidget("click","new_user_with_one_tap"),window.location.href=this.$localePrefix(l))},authorizeWithOneTap(e,t){if(t){return new v(this.$httpGql,this.$logger).authorizeWithOneTap(e).then((e=>e.data?e.data:e))}return this.$http({handleApiErrors:!1}).url("/signup/one-tap-redirect-url?credential=".concat(encodeURI(e))).get().json()},logIn(e,t){const{nonce:n}=Object(c.b)(t);return r.a.withSso({email:e,clientId:this.clientId,provider:"google",authResponse:{id_token:t},...n===Object(c.d)()?{state:n}:{}},null,this.$store.state.forter.token)}}}),O=Object(w.a)(k,(function(){var e=this._self._c;this._self._setupProxy;return e("div")}),[],!1,null,null,null);t.default=O.exports},233:function(e,t,n){"use strict";let o;function r(e){return o||(o="undefined"!=typeof navigator?navigator.userAgent:""),/Upwork (Android|iOS)/.test(e||o)}n.d(t,"a",(function(){return r}))},234:function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"f",(function(){return v})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return O}));var o=n(44),r=n(29),c=n(233),l=n(18);const d="signup_OAuth2State",h="undefined"!=typeof navigator?navigator.userAgent:"",w=e=>JSON.parse(atob(e.split(".")[1].replace("-","+").replace("_","/"))),f=()=>Object(c.a)()?Object(o.a)(h)?"android":function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return Object(c.a)(e)&&/Freelancer/.test(e)}()?"appIosFL":"appIosCL":"web",m=async()=>l.communicationProtocol.isNativeFeatureAvailable("sso").then((e=>e)),v=(e,t)=>new Promise(((n,o)=>{let r;"google"===e?r=["email","profile"]:"apple"===e&&(r=["email","fullName"]),l.communicationProtocol.on("up/sso/v1/LOGIN/events/SUCCESS","signUp",(e=>{n({idToken:e.idToken,ssoUser:w(e.idToken),response:e})})),l.communicationProtocol.on("up/sso/v1/LOGIN/events/ERROR","signUp",(e=>{o(e)})),l.communicationProtocol.postMessage({type:"up/sso/v1/LOGIN",payload:{id:"signUp",scopes:r,clientId:"google"===e?t:null,provider:e}})})),k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(r.a.get(d))return r.a.get(d);const t=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<40;i+=1)t.push(n.charAt(Math.floor(62*Math.random())));const o="".concat(e).concat(t.join(""));return r.a.set(d,o,864e5),o},O=()=>r.a.get(d)},344:function(e){e.exports=JSON.parse('{"asui_PleaseWait_12":"Please wait..."}')},345:function(e){e.exports=JSON.parse("{}")},362:function(e,t,n){"use strict";var o=n(19),r=n(62),c=n(63),l=n(68),d=n(70),h=n(69),w=n(0),f=n(47),m=n(37),v={en:n(344),is:n(345)};w.default.use(f.a);var k=new f.a({fallbackLocale:"en",silentFallbackWarn:!0,locale:"undefined"==typeof window?"en":Object(m.a)("lang")||"en",messages:v}),O="cloudflare";let y={};var _={externalCaptchaRequested:async e=>!(403!==e.status&&503!==e.status||!(null!=e.headers.get("cf-chl-bypass")||e.headers.get("cf-mitigated")&&"challenge"===e.headers.get("cf-mitigated")||-1!==(await e.clone().text()).indexOf("cloudflare.com")))&&O,async handle(e,t){let n=y[e];return n||(P("user_challenged"),await Promise.all(Object.values(y)),n=async function(e){const iframe=await function(e){const iframe=document.createElement("iframe");Object.assign(iframe.style,{width:"100%",height:"100%",position:"fixed","z-index":99999999,backgroundColor:"white",top:0}),iframe.style.setProperty("display","block","important"),iframe.setAttribute("id","externalChallenge"),iframe.innerText=k.t("asui_PleaseWait_12"),document.body.appendChild(iframe);const t=new Promise((e=>{iframe.onload=()=>{iframe.onload=void 0,iframe.prevContentDocument=iframe.contentDocument,e(iframe)}}));return iframe.src="".concat(e+(e.includes("?")?"&":"?"),"cloudflareLoader"),t}(e);do{await x(iframe)}while(!await T(e));iframe.remove()}(t),y[e]=n,n.then((()=>{delete y[e],setTimeout((()=>{P("challenge_passed")}),1e3)})))}};async function T(e){const t=await fetch(e+(e.includes("?")?"&":"?")+"endpointCheck");return 403===t.status&&P("challenge_failed"),403!==t.status}function x(iframe){return new Promise((e=>{const t=setInterval((()=>{iframe.contentDocument!==iframe.prevContentDocument&&(iframe.prevContentDocument=iframe.contentDocument,P("challenge_tried"),clearInterval(t),e())}),300)}))}function P(e){"undefined"!=typeof window&&window.$nuxt&&window.$nuxt.$tracker&&window.$nuxt.$tracker.track({event:"impression",sublocation:"page",label:e,trackers:["snowplow"]})}let j=[(e,t,n)=>401!==e.status||t.tokenRefreshWasPerformed?e:(t.tokenRefreshWasPerformed=!0,$(h.a).middlewares([Object(r.a)(),Object(c.a)([Object(d.a)()])],!0).get().res((()=>n())))],C=[e=>(t,n)=>function o(){return e(t,n).then((async e=>{const n=await _.externalCaptchaRequested(e);return n?(await _.handle(n,t),o()):e}))}()],I={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"};var S={getInterceptors:()=>j,getMiddlewares:()=>C,getHeaders:()=>Object.assign({},I),addInterceptor(e){j.push(e)},setHeader(header,e){I[header]=e}},$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(o.a)(e).options({context:n}).headers(S.getHeaders()).middlewares([...S.getMiddlewares(),Object(r.a)(),Object(c.a)([...S.getInterceptors(),...t])]).options({credentials:"same-origin",requestInfo:new l.a})},A=n(38),L=n(30);var W={openWebsocketWithToken(e){e||(e=L.a.getValueFromNameSelector(L.a.getPrefix()+"oauth2_global_js_token"));const t=window.NUXT_APP_CONFIG?NUXT_APP_CONFIG.transportLayerEndpoint:Applet.getVar("transport_layer_url");if(!t)throw new Error("Transport layer endpoint is not defined");return new WebSocket("".concat(t,"?app=AccountSecurity&libVersion=4.8.0&oauth2_token=").concat(e,"&X-Atmosphere-tracking-id=0&X-Atmosphere-Framework=2.3.8-javascript&X-Atmosphere-Transport=websocket&X-Atmosphere-TrackMessageSize=true&X-atmo-protocol=true"))}};var U=e=>async(t,n,o)=>{const data=t.data||{};if(n.locked=1!==n.retryCounter&&!!data.securityCheckCertificate,e&&e(n.locked),!n.locked)return t;await new Promise((async e=>{await function(e,t,n,o){if(e.resolve=o,e.webSocket)return Promise.resolve();return e.webSocket=W.openWebsocketWithToken(t),e.webSocket.onmessage=t=>{var n;let data={};try{data=JSON.parse(t.data)}catch(e){}"LOGIN_DECISION_AVAILABLE"===(null===(n=data)||void 0===n?void 0:n.eventName)&&(e.resolve(),e.webSocket.close()),e.webSocket.onclose=()=>e.webSocket=null},new Promise((t=>{e.webSocket.onopen=t,setTimeout(t,2e3)}))}(n,data.authToken,data.requestId,e),setTimeout((()=>e()),void 0===n.retryCounter?0:6e3)}));const r=JSON.parse(n.body);return Object.assign(r.login,{securityCheckCertificate:data.securityCheckCertificate,authToken:data.authToken}),n.body=JSON.stringify(r),n.retryCounter=void 0===n.retryCounter?30:n.retryCounter-1,o()};var N=n(233);const R="password",E="sso",D="challenge";let G=null,M={};function F(e){return 1===e.success?Promise.resolve(!0):Promise.reject(null==e?void 0:e.mode)}async function X(data){const e=Object(N.a)();return data.iovation||(data.iovation=await new Promise((async e=>{setTimeout((()=>e("")),1e3),e(await((e,t)=>{window.io_global_object_name="IGLOO";const n=new Promise((e=>{const t=setTimeout((()=>e("")),3e3);window.IGLOO=window.IGLOO||{enable_flash:!1,bb_callback:(n,o)=>{t&&clearTimeout(t),o&&e(n)},loader:{uri_hook:"/iojs",version:"general5"}}})),o=()=>{const script=document.createElement("script");script.type="text/javascript",script.src="https://www.upwork.com/static/iovation/5.2.2/loader_only.js",document.body.appendChild(script)};"loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o,{once:!0});const r={bbPromise:n,getBlackbox:()=>window.IGLOO.getBlackbox()};return e?t("iovation",r):r})().bbPromise)}))),e&&(data.rememberme=!0),$(A.a,[U()]).headers(M).post({login:data}).json((t=>{if(0===(null==t?void 0:t.challengeType)&&G){const n={login:{deviceAuthorization:{answer:G,remember:!0},mode:D,iovation:data.iovation,authToken:null==t?void 0:t.authToken,forterToken:data.forterToken,challengeData:null==t?void 0:t.challengeData}};return e&&(n.rememberme=!0),data.username?n.login.username=data.username:n.login.ssoUserData=data.ssoUserData,function(data){return $(A.a).headers(M).post(data).json((e=>F(e)))}(n)}return F(t)}))}t.a={headers(e){return M=e,this},provideSecurityAnswer(e){return G=e,this},withSso:function(e){return X({mode:E,ssoUserData:e,iovation:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,forterToken:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null})},withPassword:function(e,t){return X({mode:R,username:e,password:t,iovation:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,forterToken:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null})}}}}]);
//# sourceMappingURL=https://upwork-usw2-staging-assets-jsmaps.s3.us-west-2.amazonaws.com/Brontes/up-s-google-one-tap.e25c7a34.js.map